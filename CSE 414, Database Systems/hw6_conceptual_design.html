<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html>
<head>
<title>CSE 414 Homework 6</title>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
</head>

<body>
<h1>CSE 414 Homework 6: Conceptual Design</h1>
<dl>
  <dt><b>Objectives:</b> </dt>
  <dd>To be able to translate from E/R diagrams to a relational
database, and to understand functional dependencies and normal forms. </dd>
  <dt><b>Reading assignments:</b> </dt>
  <dd>Chapters: 3.1-3.4, 4.1-4.6</dd>
  <dt><b>Assignment tools:</b> </dt>
  <dd>SQLite  (or any other relational DBMS) for problem 5 below.</dd>
  <dt><b>Additional files:</b> </dt>
  <dd><a href="hw6.tar.gz">mrFrumbleData.txt</a></dd>
  <dt><b>Due date:</b> </dt>
  <dd>Friday May 20th, 2016, at 11:00 pm. Turn in your solution using the assignment drop box linked from the main course web page.</dd>
</dl>
<ol>
  <li> [4 points] Design an E/R diagram for geography that contains
the following kinds of objects together with the listed attributes:
    <ul>
      <li> countries: name, area, population, gdp ("gross domestic product") </li>
      <li> cities: name, population, longitude, latitude </li>
      <li> rivers: name, length </li>
      <li> seas: name, max depths </li>
    </ul>
Model the following relationships between the geographical objects:
    <ul>
      <li> each city belongs to exactly one country </li>
      <li> each river crosses one or several countries </li>
      <li> each river ends in a river or in a sea </li>
    </ul>
    You can draw your diagrams on paper and scan them or use powerpoint (or equivalent). Please only turn in PDF files.
  </li>
  <p> </p>
  <li>[4 points] Consider the following E/R diagram: <br>
    <img src="ps2-figure.png" alt="E/R Diagram">
    <ol type="a">
      <li>Write the SQL CREATE TABLE statements to represent  this E/R diagram.
Include all keys, foreign keys, and uniqueness constraints.
      You do not need to run these commands in SQL.</li>
      <li>Which relation in your relational schema represents the
relationship "insures", in the E/R diagram and why is that your
representation? </li>
      <li>Compare the representation of the relationships "drives" and
"operates" in your schema, and explain why they are different. </li>
    </ol>
  </li>
  <p> </p>
  <li>[4 points] Consider the following two relational schemas and
sets of functional dependencies:
    <ol type="i">
      <li>R(A,B,C,D,E) with functional dependencies D &rarr; B, CE &rarr; A. </li>
      <li>S(A,B,C,D,E) with functional dependencies A &rarr; E, BC &rarr; A, DE &rarr; B. </li>
    </ol>
For each of them, decompose it into BCNF. Show all of your work and explain, at each step, which
dependency violations you are correcting.
You have to turn in a description
of your decomposition steps.<br>
<br>
  <li>[4 points] A set of attributes X is called <i>closed</i> (with
respect to a given set of functional dependencies) if X<sup>+</sup>=X.
Consider a relation with schema R(A,B,C,D) and an unknown set
      of functional dependencies. For each closed attribute set below, give a
    set of functional dependencies that is consistent with it. 
    <ol type="a">
      <li>All sets of attributes are closed. </li>
      <li>The only closed sets are {} and {A,B,C,D}. </li>
      <li>The only closed sets are {}, {A,B}, and {A,B,C,D}. </li>
    </ol>
  </li>
  <p> </p>
  <li>[8 points] <a href="MrfrumblesABC.gif">Mr. Frumble</a> (who is
a great character for small kids that always gets into trouble)
designed a simple database to record projected monthly sales in his
small store. He never took a database class, so he came up with the
following schema: 
    <center> 
      <b><font color="#0000ff">Sales(name, discount, month,
    price)</font></b> </center>
    <p> He inserted his data into the database, then he realized that
there is something wrong with it: it was difficult to update. He hires
you as a consultant to fix his data management problems. He gives you this file <a href="hw6.tar.gz">mrFrumbleData.txt</a> and
says: "Fix it for me!". Help him by normalizing his
database. Unfortunately you cannot sit down and talk to Mr. Frumble to find out what functional dependencies make sense in his business.  Instead, you will reverse engineer the functional dependencies from his data
instance. You should do the following steps:</p>
    <ol type="i">
      <li>Create a table in the database and load the data from the
provided file into that table; use SQLite or  any other relational DBMS if your choosing. You don't need to turn in anything for this point.<br>
      </li>
      <p> </p>
      <li>Find all functional dependencies in the database. This is a
reverse engineering task, so expect to proceed in a trial and error
fashion. Search first for the simple dependencies, say <b><font
 color="#0000ff">name &rarr; discount </font></b>then try the more
complex ones, like <font color="#0000ff"><b>name, discount &rarr; month</b></font>,
as needed. To check each functional dependency you have to write a SQL
query. Your challenge is to write this SQL query for every candidate
functional dependency that you check, such that (a) the query's answer
is always short (say: no more than ten lines or so), and (b) you can
determine whether the FD holds or not by looking at the query's answer.
Try to be clever in order not to check too many dependencies, but don't
miss potential relevant dependencies.
        <p> For this point you should turn in all functional
dependencies that you found, and for each of them the SQL query that
discovered it, together with the answer of the query.</p>
        <p> </p>
      </li>
      <li>Decompose the table in BCNF, and create SQL tables for the
decomposed schema. Create keys and foreign keys where appropriate.
        <p> For this point turn in the SQL commands for creating the
tables. </p>
        <p> </p>
      </li>
      <li>Populate your BCNF tables from Mr. Frumble's data. For this
you need to write SQL queries that load the tables you created at point
iii from the table you created at point i.
        <p> Here, turn in the SQL queries that load the tables, and the
tables' contents after loading them (obtained by running SELECT * FROM
Table). </p>
      </li>
    </ol>
  </li>
</ol>
</body>
</html>
